# q v2

In q v2, we will build a whole new framework with a modular and extensible architecture. It will also be model-agnostic, enabling prompt and framework reuse across Claude, GPT, and any other model.

In q v2 we will also enable conversations  to use any combination of commands. Each conversation is separated by active terminal sessions, and a new session can load another session with its id.  

## Commands

### Text

The class for this command will likely serve as the base for all other text-based commands. 

This command provides a pure prompt without any system message. It is useful as a starting point when using q from other programs, but for CLI usage you would likely rather use -e for most things.

Text prompt:
```
$ q -t <text>
```

Text prompt with an input file as context:
```
$ q -t <text> -f <input_file>
```

### Code

Generate code snippets:
```
$ q -c <text>
```

Generate code snippets with an input file as context:
```
$ q -c <text> -f <input_file>
```

Generate code to an output file:
```
$ q -c <text> -o <output_file>
```

Generate code snippets with the current working directory as context:
```
$q -cd <text>
```

### Shell

Fix the last shell command from its output:
```
$ q -s
```

Fix the last shell command and execute it:
```
$ q -s -x
$ q -sx
```

Generate shell commands:
```
$ q -s <text>
```

Generate and execute shell commands:
```
$ q -s <text> -x
$ q -sx <text>
```

### Explain

Explain the output of the last shell command:
```
$ q -e
```

Explain a code snippet or something else:
```
$ q -e <text>
```

Explain the contents of a file:
```
$ q -ef <input_file>
```

### Web Search

Search the web:
```
$ q -w <text>
```

### Image

Generate an image:
```
$ q -i <text>
```

Edit an image:
```
$ q -i <text> -f <input_file>
```

Generate an image and save it to a file:
```
$ q -i <text> -o <output_file>
```

### Meta q

Let `q` generate the appropriate `q` command for a task:

```
$ q -q "Generate an image of a cat and save it to cat.png"
q -i "a cat" -o cat.png
```

This is a very interesting idea. Behind the scenes we could pass the help text from `q -h` and specify it not to generate any `-q` commands itself to prevent recursive calls.

### Other Options

Overwrite previous message:
```
$ q -sz
```

Overwrite previous message with same command:
```
$ q -z <text>
```

Overwrite last n messages:
```
$ q -z <n> <text>
```

Print model parameters and message history:
```
$ q -v
```

## CLI Flags

All characters are mapped to a single command or option, enabling them to be combined in nearly any way. We also ditch the long-form options for simplicity.

| Flag | Name           | Input   | Description                  | Type    |
| ---- | -------------- | ------- | -----------------------------| ------: |
| `-a` | agent          | ?       | (reserved for future use)    | Command |
| `-b` |                |         |                              |         |
| `-c` | code           | str     | generate code                | Command |
| `-d` | directory      | - / str | add a directory to context   | Option  |
| `-e` | explain        | - / str | explain code or text         | Command |
| `-f` | input file     | str     | read input from file         | Option  |
| `-g` |                |         |                              |         |
| `-h` | help           | -       | help message                 | Command |
| `-i` | image          | str     | generate/edit an image       | Command |
| `-j` | json           | -       | output as JSON               | Option  |
| `-k` |                |         |                              |         |
| `-l` | load session   | str     | load another conversation    | Option  |
| `-m` | model          | str     | override model               | Option  |
| `-n` |                |         |                              |         |
| `-o` | output file    | str     | write output to file         | Option  |
| `-p` |                |         |                              |         |
| `-q` | meta `q`       | str     | generate a `q` command       | Command |
| `-r` |                |         |                              |         |
| `-s` | shell          | - / str | generate a shell command     | Command |
| `-t` | text           | str     | generate text                | Command |
| `-u` | user command   | str     | run from ~/.q/commands/      | Command |
| `-v` | verbose        | -       | print parameters and history | Option  |
| `-w` | web search     | str     | search the web               | Command |
| `-x` | execute        | -       | execute a shell command      | Option  |
| `-y` |                |         |                              |         |
| `-z` | undo           | - / int | undo messages                | Option  |
